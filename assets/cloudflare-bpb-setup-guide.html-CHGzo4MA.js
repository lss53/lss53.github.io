import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as n,o as l}from"./app-CIJU17ei.js";const e={};function t(h,s){return l(),a("div",null,[...s[0]||(s[0]=[n(`<h2 id="项目概述" tabindex="-1"><a class="header-anchor" href="#项目概述"><span>项目概述</span></a></h2><ul><li><strong>仓库名称</strong>: Worker-AutoSync</li><li><strong>核心功能</strong>: 自动同步上游 BPB Worker Panel 代码 + Cloudflare Pages 部署</li><li><strong>自动化组件</strong>: GitHub Actions 工作流</li><li><strong>部署平台</strong>: Cloudflare Pages</li></ul><h2 id="第一部分-github-actions-自动同步配置" tabindex="-1"><a class="header-anchor" href="#第一部分-github-actions-自动同步配置"><span>第一部分：GitHub Actions 自动同步配置</span></a></h2><h3 id="工作流配置" tabindex="-1"><a class="header-anchor" href="#工作流配置"><span>工作流配置</span></a></h3><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-yml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 文件位置: .github/workflows/sync_worker_code.yml</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">同步上游 Worker 代码 (Zip 解压优化版)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  schedule</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cron</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;0 2 * * 1&#39;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每周一02:00 UTC运行一次</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  workflow_dispatch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:      </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 允许手动触发</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">jobs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    runs-on</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ubuntu-latest</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    permissions</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      contents</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">write</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    steps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Checkout 仓库</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        uses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">actions/checkout@v4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 步骤 1: 获取版本信息并判断是否需要更新</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">检查版本并获取最新版本</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">check_versions</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          # 1. 获取最新正式版标签</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          LATEST_TAG=$(curl -s https://api.github.com/repos/bia-pain-bache/BPB-Worker-Panel/releases/latest | jq -r &#39;.tag_name&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          if [ -z &quot;$LATEST_TAG&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            echo &quot;::error::未找到最新正式发布版本，退出。&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            exit 1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          fi</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          # 2. 获取本地版本</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          if [ -f &quot;version.txt&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            CURRENT_VERSION=$(cat version.txt | tr -d &#39;\\n&#39; | tr -d &#39;\\r&#39;)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          else</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            CURRENT_VERSION=&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          fi</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          echo &quot;最新版本: $LATEST_TAG&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          echo &quot;当前本地版本: \${CURRENT_VERSION:-未找到}&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          # 3. 比较版本，设置是否需要更新</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          if [ &quot;$CURRENT_VERSION&quot; = &quot;$LATEST_TAG&quot; ]; then</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            echo &quot;No update needed.&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            echo &quot;need_update=false&quot; &gt;&gt; $GITHUB_ENV</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          else</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            echo &quot;Update needed. New tag: $LATEST_TAG&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            echo &quot;latest_tag=$LATEST_TAG&quot; &gt;&gt; $GITHUB_ENV</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            echo &quot;need_update=true&quot; &gt;&gt; $GITHUB_ENV</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            echo &quot;download_url=https://github.com/bia-pain-bache/BPB-Worker-Panel/releases/download/$LATEST_TAG/worker.zip&quot; &gt;&gt; $GITHUB_ENV</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          fi</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 步骤 2: 下载、解压文件并更新版本号 (仅在需要更新时执行)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 优化：不再手动安装 unzip，ubuntu-latest 默认包含了大多数常用工具</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">下载并解压 worker.zip</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">env.need_update == &#39;true&#39;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        run</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          TEMP_ZIP=&quot;worker_temp.zip&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          echo &quot;正在下载文件: \${{ env.download_url }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          # 使用 curl 下载 zip 文件</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          curl -L -o &quot;$TEMP_ZIP&quot; &quot;\${{ env.download_url }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          echo &quot;正在解压文件...&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          # 解压 zip 文件到当前目录，这将覆盖 _worker.js</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          unzip -o &quot;$TEMP_ZIP&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          # 删除临时下载的 zip 文件</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          rm &quot;$TEMP_ZIP&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          # 将最新标签名写入 version.txt</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          echo &quot;\${{ env.latest_tag }}&quot; &gt; version.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 步骤 3: 提交更改 (使用专用的 Git Auto Commit Action 替代原生 git 命令)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 优化：使用 Action 替代 4 行原生 shell 命令</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">提交更新到 GitHub</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">env.need_update == &#39;true&#39;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        uses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">stefanzweifel/git-auto-commit-action@v5</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">        with</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">          commit_message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;🔄 Auto Sync Worker: Update to version \${{ env.latest_tag }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 不使用 --force，因为我们只是在添加或修改 _worker.js 和 version.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="wrangler-配置" tabindex="-1"><a class="header-anchor" href="#wrangler-配置"><span>Wrangler 配置</span></a></h3><div class="language-toml line-numbers-mode" data-highlighter="shiki" data-ext="toml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-toml"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 文件: wrangler.toml</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;wk-auto-updater-zip&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;_worker.js&quot;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">compatibility_date</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;2024-10-23&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="验证步骤" tabindex="-1"><a class="header-anchor" href="#验证步骤"><span>验证步骤</span></a></h3><ol><li>确保 GitHub Actions 工作流文件正确配置</li><li>访问 Actions → 同步上游 Worker 代码 (Zip 解压版) → Run workflow</li><li>刷新页面确认工作流执行成功</li></ol><h2 id="第二部分-cloudflare-pages-初始部署" tabindex="-1"><a class="header-anchor" href="#第二部分-cloudflare-pages-初始部署"><span>第二部分：Cloudflare Pages 初始部署</span></a></h2><h3 id="创建-cloudflare-账户" tabindex="-1"><a class="header-anchor" href="#创建-cloudflare-账户"><span>创建 Cloudflare 账户</span></a></h3><ol><li>注册/登录 Cloudflare 账户</li></ol><h3 id="创建-pages-项目" tabindex="-1"><a class="header-anchor" href="#创建-pages-项目"><span>创建 Pages 项目</span></a></h3><ol><li>控制台 → 技术和AI → Workers 和 Pages → 创建应用程序</li><li>选择 Pages 选项卡 → 导入现有 Git 存储库 → 开始使用</li><li>连接 GitHub 账户 → 选择 <code>Worker-AutoSync</code> 仓库</li><li>保存并部署 → 继续处理项目</li></ol><h3 id="处理预期错误" tabindex="-1"><a class="header-anchor" href="#处理预期错误"><span>处理预期错误</span></a></h3><p>部署完成后，访问页面会出现错误：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>❌ Something went wrong!</span></span>
<span class="line"><span>Please set UUID and Trojan password first. Please visit here to generate them.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>这是正常现象</strong>，按照以下步骤解决：</p><ol><li>点击错误信息中的 &quot;here&quot; 链接</li><li>在新页面中生成 UUID 和密码</li><li><strong>重要</strong>: 不要关闭此页面，后续步骤需要使用</li></ol><h2 id="第三部分-cloudflare-环境配置" tabindex="-1"><a class="header-anchor" href="#第三部分-cloudflare-环境配置"><span>第三部分：Cloudflare 环境配置</span></a></h2><h3 id="创建-workers-kv-存储" tabindex="-1"><a class="header-anchor" href="#创建-workers-kv-存储"><span>创建 Workers KV 存储</span></a></h3><ol><li>控制台 → 存储与数据库 → Workers KV</li><li>点击 &quot;Create Instance&quot;</li><li>输入命名空间名称 → 创建</li></ol><h3 id="绑定-kv-到-pages-项目" tabindex="-1"><a class="header-anchor" href="#绑定-kv-到-pages-项目"><span>绑定 KV 到 Pages 项目</span></a></h3><ol><li>返回 Pages 项目 → 设置 → 绑定</li><li>点击 &quot;添加绑定&quot;</li><li>选择 &quot;KV 命名空间&quot;</li><li>变量名称: <code>kv</code></li><li>KV 命名空间: 选择刚创建的命名空间</li><li>保存</li></ol><h3 id="配置环境变量" tabindex="-1"><a class="header-anchor" href="#配置环境变量"><span>配置环境变量</span></a></h3><ol><li>Pages 项目 → 设置 → 变量与机密</li><li>点击 &quot;添加变量&quot;</li><li>返回之前生成的密钥页面，点击 &quot;Copy all&quot;</li><li>在变量名称处右键粘贴，系统会自动识别并添加三个参数</li><li>保存</li></ol><h2 id="第四部分-完成部署" tabindex="-1"><a class="header-anchor" href="#第四部分-完成部署"><span>第四部分：完成部署</span></a></h2><h3 id="重新部署项目" tabindex="-1"><a class="header-anchor" href="#重新部署项目"><span>重新部署项目</span></a></h3><ol><li>Pages 项目 → 部署 → 所有部署</li><li>选择最新部署 → 点击横向三点菜单 → 重试部署</li><li>等待部署完成</li></ol><h3 id="访问和管理面板" tabindex="-1"><a class="header-anchor" href="#访问和管理面板"><span>访问和管理面板</span></a></h3><ol><li>部署完成后，访问 &quot;域&quot; 链接 + <code>/panel</code><ul><li>例如: <code>https://your-project.pages.dev/panel</code></li></ul></li><li>设置管理员密码 <ul><li>要求: 至少8位，包含大写字母和数字</li></ul></li><li>使用新密码登录</li></ol><h2 id="第五部分-高级优化配置-可选" tabindex="-1"><a class="header-anchor" href="#第五部分-高级优化配置-可选"><span>第五部分：高级优化配置（可选）</span></a></h2><h3 id="代理-ip-优化" tabindex="-1"><a class="header-anchor" href="#代理-ip-优化"><span>代理 IP 优化</span></a></h3><ol><li>Pages 项目 → 设置 → 变量和机密 → 添加</li><li>变量名称: <code>PROXY_IP</code></li><li>值: <code>bpb.yousef.isegaro.com</code> 或 <a href="https://www.nslookup.io/domains/bpb.yousef.isegaro.com/dns-records/" target="_blank" rel="noopener noreferrer">IP 列表</a><code>151.213.181.145, 5.163.51.41, bpb.yousef.isegaro.com</code></li><li>保存</li></ol><h3 id="nat64-预设修复" tabindex="-1"><a class="header-anchor" href="#nat64-预设修复"><span>NAT64 预设修复</span></a></h3><ol><li>同上位置添加变量</li><li>变量名称: <code>NAT64_PREFIX</code></li><li>值: 从 <a href="https://github.com/bia-pain-bache/BPB-Worker-Panel/blob/main/NAT64Prefixes.md" target="_blank" rel="noopener noreferrer">NAT64 前缀列表</a> 获取</li><li>保存</li></ol><h3 id="设置回退域" tabindex="-1"><a class="header-anchor" href="#设置回退域"><span>设置回退域</span></a></h3><ol><li>同上位置添加变量</li><li>变量名称: <code>FALLBACK</code></li><li>值: 例如 <code>npmjs.org</code></li><li>保存</li></ol><h3 id="更改订阅路径" tabindex="-1"><a class="header-anchor" href="#更改订阅路径"><span>更改订阅路径</span></a></h3><ol><li>同上位置添加变量</li><li>变量名称: <code>SUB_PATH</code></li><li>值: 使用 <a href="https://1024tools.com/uuid" target="_blank" rel="noopener noreferrer">UUID 生成器</a> 生成或自定义路径</li><li>保存并重新部署</li></ol><h3 id="自定义域名" tabindex="-1"><a class="header-anchor" href="#自定义域名"><span>自定义域名</span></a></h3><ol><li>Pages 项目 → 自定义域 → 设置自定义域</li><li>输入域名 (如 <a href="http://shop.example.com" target="_blank" rel="noopener noreferrer">shop.example.com</a>)</li><li>继续 → 激活域名</li></ol><h2 id="第六部分-订阅使用" tabindex="-1"><a class="header-anchor" href="#第六部分-订阅使用"><span>第六部分：订阅使用</span></a></h2><h3 id="清洁-ip-扫描-可选" tabindex="-1"><a class="header-anchor" href="#清洁-ip-扫描-可选"><span>清洁 IP 扫描(可选)</span></a></h3><ul><li>登录面板 → VLESS - Trojan → Clean IPs / Domains</li><li><strong>工具</strong>: <a href="https://github.com/bia-pain-bache/Cloudflare-Clean-IP-Scanner" target="_blank" rel="noopener noreferrer">Cloudflare Clean IP Scanner</a>、<a href="https://github.com/XIU2/CloudflareSpeedTest" target="_blank" rel="noopener noreferrer">CloudflareSpeedTest</a></li><li><strong>使用方法</strong>: 下载运行，结果保存在 result.csv</li><li><strong>建议</strong>: Windows 环境运行，测试时断开 VPN</li><li>其他保存默认。点 Apply 。</li></ul><h3 id="获取订阅链接" tabindex="-1"><a class="header-anchor" href="#获取订阅链接"><span>获取订阅链接</span></a></h3><ol><li>登录面板 → Subscriptions → Normal</li><li>根据使用的代理软件，点击对应的 &quot;Copy subscription URL&quot;</li><li>复制生成的订阅链接</li></ol><h2 id="参考资源" tabindex="-1"><a class="header-anchor" href="#参考资源"><span>参考资源</span></a></h2><p><a href="https://hanscn.com/post/bpb" target="_blank" rel="noopener noreferrer">https://hanscn.com/post/bpb</a></p><p><a href="https://www.kekehub.com/2025/09/bpbnat.html" target="_blank" rel="noopener noreferrer">https://www.kekehub.com/2025/09/bpbnat.html</a></p><p><a href="https://bia-pain-bache.github.io/BPB-Worker-Panel/installation/pages-manual" target="_blank" rel="noopener noreferrer">https://bia-pain-bache.github.io/BPB-Worker-Panel/installation/pages-manual</a></p>`,51)])])}const d=i(e,[["render",t]]),o=JSON.parse('{"path":"/dev/automation/cloudflare-bpb-setup-guide.html","title":"BPB Worker Panel 完整部署指南：自动同步与Cloudflare配置","lang":"zh-CN","frontmatter":{"title":"BPB Worker Panel 完整部署指南：自动同步与Cloudflare配置","shortTitle":"BPB Worker Panel 部署指南","date":"2025-10-27T00:00:00.000Z","icon":"cloud","order":5,"category":["自动化脚本"],"tag":["BPB","Cloudflare","GitHub Actions","自动同步","网络部署"],"description":"完整详细的 BPB Worker Panel 部署指南，涵盖 GitHub Actions 自动代码同步和 Cloudflare Pages 手动配置，包含基础部署、高级优化和故障排除，帮助用户快速搭建稳定的网络代理服务。","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"BPB Worker Panel 完整部署指南：自动同步与Cloudflare配置\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-10-27T00:00:00.000Z\\",\\"dateModified\\":\\"2025-10-27T10:24:09.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"诗往哥\\",\\"url\\":\\"/intro.html\\"}]}"],["meta",{"property":"og:url","content":"https:////211777.xyz/dev/automation/cloudflare-bpb-setup-guide.html"}],["meta",{"property":"og:site_name","content":"诗往哥的博客"}],["meta",{"property":"og:title","content":"BPB Worker Panel 完整部署指南：自动同步与Cloudflare配置"}],["meta",{"property":"og:description","content":"完整详细的 BPB Worker Panel 部署指南，涵盖 GitHub Actions 自动代码同步和 Cloudflare Pages 手动配置，包含基础部署、高级优化和故障排除，帮助用户快速搭建稳定的网络代理服务。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-10-27T10:24:09.000Z"}],["meta",{"property":"article:tag","content":"网络部署"}],["meta",{"property":"article:tag","content":"自动同步"}],["meta",{"property":"article:tag","content":"GitHub Actions"}],["meta",{"property":"article:tag","content":"Cloudflare"}],["meta",{"property":"article:tag","content":"BPB"}],["meta",{"property":"article:published_time","content":"2025-10-27T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-10-27T10:24:09.000Z"}]]},"git":{"createdTime":1761560649000,"updatedTime":1761560649000,"contributors":[{"name":"lss53","username":"lss53","email":"2720626504@qq.com","commits":1,"url":"https://github.com/lss53"}]},"readingTime":{"minutes":4.89,"words":1467},"filePathRelative":"dev/automation/cloudflare-bpb-setup-guide.md","excerpt":"<h2>项目概述</h2>\\n<ul>\\n<li><strong>仓库名称</strong>: Worker-AutoSync</li>\\n<li><strong>核心功能</strong>: 自动同步上游 BPB Worker Panel 代码 + Cloudflare Pages 部署</li>\\n<li><strong>自动化组件</strong>: GitHub Actions 工作流</li>\\n<li><strong>部署平台</strong>: Cloudflare Pages</li>\\n</ul>\\n<h2>第一部分：GitHub Actions 自动同步配置</h2>\\n<h3>工作流配置</h3>"}');export{d as comp,o as data};
